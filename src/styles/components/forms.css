/**
 * ============================================
 * FORMS - Système de formulaires réutilisables
 * ============================================
 *
 * Système complet pour inputs, selects, textareas avec validation.
 * Extrait et amélioré depuis nightlife-theme.css (lignes 910-1043)
 *
 * USAGE:
 * <div class="form-group">
 *   <label class="form-label" for="email">Email</label>
 *   <input type="email" class="form-control" id="email" />
 *   <span class="form-error">Error message</span>
 * </div>
 *
 * @dependencies design-system.css (variables)
 */

/* ============================================
   FORM GROUPS
   ============================================ */

/**
 * Container for label + input + error message
 */
.form-group {
  margin-bottom: var(--spacing-6);
}

.form-group--inline {
  display: flex;
  align-items: center;
  gap: var(--spacing-4);
}

/* ============================================
   FORM LABELS
   ============================================ */

/**
 * Label for form controls
 */
.form-label {
  display: block;
  margin-bottom: var(--spacing-2);
  font-size: var(--font-base);
  font-weight: var(--font-weight-semibold);
  color: var(--color-secondary);
  text-shadow: 0 0 10px rgba(44, 62, 80, 0.3);
  line-height: var(--line-height-normal);
}

/* Required field indicator */
.form-label--required::after {
  content: ' *';
  color: var(--color-error);
}

/* Optional field indicator */
.form-label--optional::after {
  content: ' (optional)';
  font-size: var(--font-sm);
  font-weight: var(--font-weight-normal);
  color: var(--text-muted);
}

/* ============================================
   FORM CONTROLS - Base
   ============================================ */

/**
 * Base class for all form inputs
 * Includes inputs, selects, textareas
 */
.form-control {
  /* Layout */
  display: block;
  width: 100%;

  /* Sizing */
  min-height: var(--height-input); /* 44px - WCAG touch target */
  padding: var(--spacing-3) var(--spacing-4);

  /* Typography */
  font-family: var(--font-family-base);
  font-size: var(--font-base);
  font-weight: var(--font-weight-normal);
  line-height: var(--line-height-normal);
  color: var(--text-primary);

  /* Visual */
  background: var(--bg-secondary);
  border: 2px solid var(--border-color);
  border-radius: var(--border-radius-lg);
  backdrop-filter: var(--backdrop-blur-sm);

  /* Interaction */
  outline: none;
  transition: all var(--duration-normal) var(--ease-in-out);

  /* Appearance */
  appearance: none;
  -webkit-appearance: none;
  -moz-appearance: none;
}

/* Placeholder styling */
.form-control::placeholder {
  color: var(--text-muted);
  opacity: 1;
}

/* Focus state */
.form-control:focus {
  border-color: var(--color-primary);
  background: var(--bg-surface);
  box-shadow: var(--shadow-glow-primary);
}

/* Hover state */
.form-control:hover:not(:disabled):not(:focus) {
  border-color: var(--border-color-strong);
}

/* Disabled state */
.form-control:disabled,
.form-control[aria-disabled="true"] {
  opacity: 0.7;
  cursor: not-allowed;
  background: var(--bg-surface-alt);
  border-color: var(--border-color);
}

/* Read-only state */
.form-control:read-only {
  background: var(--bg-surface-alt);
  cursor: default;
}

/* ============================================
   FORM CONTROL VARIANTS
   ============================================ */

/**
 * Success state
 */
.form-control--success {
  border-color: var(--color-success);
}

.form-control--success:focus {
  border-color: var(--color-success);
  box-shadow: var(--shadow-glow-success);
}

/**
 * Error state
 */
.form-control--error {
  border-color: var(--color-error);
}

.form-control--error:focus {
  border-color: var(--color-error);
  box-shadow: var(--shadow-glow-error);
}

/**
 * Warning state
 */
.form-control--warning {
  border-color: var(--color-warning);
}

.form-control--warning:focus {
  border-color: var(--color-warning);
  box-shadow: 0 0 15px rgba(255, 165, 0, 0.3);
}

/* ============================================
   INPUT TYPES
   ============================================ */

/**
 * Text inputs (text, email, password, url, tel, search, etc.)
 */
input[type="text"].form-control,
input[type="email"].form-control,
input[type="password"].form-control,
input[type="url"].form-control,
input[type="tel"].form-control,
input[type="search"].form-control,
input[type="number"].form-control,
input[type="date"].form-control,
input[type="time"].form-control,
input[type="datetime-local"].form-control {
  /* Styles déjà définis par .form-control */
}

/* Remove number input spinners */
input[type="number"].form-control::-webkit-outer-spin-button,
input[type="number"].form-control::-webkit-inner-spin-button {
  -webkit-appearance: none;
  margin: 0;
}

input[type="number"].form-control {
  -moz-appearance: textfield;
}

/* Search input clear button */
input[type="search"].form-control::-webkit-search-cancel-button {
  -webkit-appearance: none;
  appearance: none;
  height: 1rem;
  width: 1rem;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23FF1B8D'%3E%3Cpath d='M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z'/%3E%3C/svg%3E");
  cursor: pointer;
}

/* ============================================
   SELECT
   ============================================ */

/**
 * Custom select dropdown
 */
select.form-control {
  padding-right: 2.5rem;
  cursor: pointer;

  /* Custom arrow */
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23FF1B8D'%3E%3Cpath d='M7 10l5 5 5-5z'/%3E%3C/svg%3E");
  background-position: right 0.75rem center;
  background-repeat: no-repeat;
  background-size: 1.5rem;
}

select.form-control:focus {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23FF1B8D'%3E%3Cpath d='M7 10l5 5 5-5z'/%3E%3C/svg%3E");
}

/* Option styling */
select.form-control option {
  background: var(--bg-primary);
  color: var(--text-primary);
  padding: var(--spacing-2);
}

/* ============================================
   TEXTAREA
   ============================================ */

/**
 * Multi-line text input
 */
textarea.form-control {
  min-height: 6.25rem; /* 100px */
  resize: vertical;
  font-family: inherit;
  line-height: var(--line-height-relaxed);
}

/* Prevent horizontal resize */
textarea.form-control:not(.form-control--resizable) {
  resize: vertical;
}

/* Allow both horizontal and vertical resize */
textarea.form-control--resizable {
  resize: both;
}

/* Fixed size (no resize) */
textarea.form-control--fixed {
  resize: none;
}

/* ============================================
   CHECKBOX & RADIO
   ============================================ */

/**
 * Custom checkbox
 */
.form-checkbox {
  display: inline-flex;
  align-items: center;
  gap: var(--spacing-2);
  cursor: pointer;
  user-select: none;
}

.form-checkbox__input {
  width: 1.25rem;
  height: 1.25rem;
  border: 2px solid var(--border-color);
  border-radius: var(--border-radius-sm);
  background: var(--bg-secondary);
  cursor: pointer;
  appearance: none;
  -webkit-appearance: none;
  transition: all var(--duration-normal) var(--ease-in-out);
  position: relative;
  flex-shrink: 0;
}

.form-checkbox__input:checked {
  background: linear-gradient(135deg, var(--color-primary), var(--color-secondary));
  border-color: var(--color-primary);
}

.form-checkbox__input:checked::after {
  content: '✓';
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  color: var(--text-inverse);
  font-size: var(--font-sm);
  font-weight: var(--font-weight-bold);
}

.form-checkbox__input:focus {
  border-color: var(--color-primary);
  box-shadow: var(--focus-ring);
}

.form-checkbox__label {
  font-size: var(--font-base);
  color: var(--text-primary);
}

/**
 * Custom radio button
 */
.form-radio {
  display: inline-flex;
  align-items: center;
  gap: var(--spacing-2);
  cursor: pointer;
  user-select: none;
}

.form-radio__input {
  width: 1.25rem;
  height: 1.25rem;
  border: 2px solid var(--border-color);
  border-radius: var(--border-radius-full);
  background: var(--bg-secondary);
  cursor: pointer;
  appearance: none;
  -webkit-appearance: none;
  transition: all var(--duration-normal) var(--ease-in-out);
  position: relative;
  flex-shrink: 0;
}

.form-radio__input:checked {
  border-color: var(--color-primary);
}

.form-radio__input:checked::after {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 0.625rem;
  height: 0.625rem;
  border-radius: var(--border-radius-full);
  background: linear-gradient(135deg, var(--color-primary), var(--color-secondary));
}

.form-radio__input:focus {
  border-color: var(--color-primary);
  box-shadow: var(--focus-ring);
}

.form-radio__label {
  font-size: var(--font-base);
  color: var(--text-primary);
}

/* ============================================
   FORM MESSAGES
   ============================================ */

/**
 * Help text
 */
.form-help {
  display: block;
  margin-top: var(--spacing-2);
  font-size: var(--font-sm);
  color: var(--text-muted);
  line-height: var(--line-height-normal);
}

/**
 * Success message
 */
.form-success {
  display: block;
  margin-top: var(--spacing-2);
  font-size: var(--font-sm);
  color: var(--color-success);
  line-height: var(--line-height-normal);
}

/**
 * Error message
 */
.form-error {
  display: block;
  margin-top: var(--spacing-2);
  font-size: var(--font-sm);
  color: var(--color-error);
  line-height: var(--line-height-normal);
  animation: formShake 0.5s var(--ease-in-out);
}

@keyframes formShake {
  0%, 100% { transform: translateX(0); }
  25% { transform: translateX(-0.5rem); }
  75% { transform: translateX(0.5rem); }
}

/**
 * Warning message
 */
.form-warning {
  display: block;
  margin-top: var(--spacing-2);
  font-size: var(--font-sm);
  color: var(--color-warning);
  line-height: var(--line-height-normal);
}

/* ============================================
   INPUT GROUPS
   ============================================ */

/**
 * Group input with addons (prefix/suffix)
 */
.input-group {
  display: flex;
  width: 100%;
}

.input-group .form-control {
  flex: 1;
  border-radius: 0;
}

.input-group .form-control:first-child {
  border-top-left-radius: var(--border-radius-lg);
  border-bottom-left-radius: var(--border-radius-lg);
}

.input-group .form-control:last-child {
  border-top-right-radius: var(--border-radius-lg);
  border-bottom-right-radius: var(--border-radius-lg);
}

/**
 * Input addon (prefix/suffix text or icon)
 */
.input-addon {
  display: flex;
  align-items: center;
  padding: var(--spacing-3) var(--spacing-4);
  background: var(--bg-surface-alt);
  border: 2px solid var(--border-color);
  color: var(--text-secondary);
  font-size: var(--font-base);
  white-space: nowrap;
}

.input-addon:first-child {
  border-top-left-radius: var(--border-radius-lg);
  border-bottom-left-radius: var(--border-radius-lg);
  border-right: none;
}

.input-addon:last-child {
  border-top-right-radius: var(--border-radius-lg);
  border-bottom-right-radius: var(--border-radius-lg);
  border-left: none;
}

/* ============================================
   FORM SIZES
   ============================================ */

/**
 * Small form controls
 */
.form-control--sm {
  min-height: 2.25rem; /* 36px */
  padding: var(--spacing-2) var(--spacing-3);
  font-size: var(--font-sm);
}

/**
 * Large form controls
 */
.form-control--lg {
  min-height: 3.5rem; /* 56px */
  padding: var(--spacing-4) var(--spacing-5);
  font-size: var(--font-lg);
}

/* ============================================
   RESPONSIVE
   ============================================ */

/**
 * Mobile: Ensure WCAG touch target sizes (44x44px)
 */
@media (max-width: 48rem) {
  .form-control {
    min-height: 2.75rem; /* 44px - WCAG 2.1 Level AAA */
    padding: var(--spacing-3) var(--spacing-4);
  }

  textarea.form-control {
    min-height: 6.25rem; /* 100px - maintain usability */
  }

  .form-control--sm {
    min-height: 2.75rem; /* Override small size on mobile */
  }
}

/* ============================================
   ACCESSIBILITY
   ============================================ */

/* High contrast mode support */
@media (prefers-contrast: high) {
  .form-control {
    border-width: 3px;
  }

  .form-control:focus {
    border-width: 3px;
    outline: 2px solid var(--color-primary);
    outline-offset: 2px;
  }
}

/* ============================================
   LEGACY SUPPORT
   ============================================ */

/**
 * Mapping ancien système → nouveau système
 * TODO: Supprimer après migration complète
 */
.input-nightlife {
  /* Utilisez .form-control */
}

.select-nightlife {
  /* Utilisez select.form-control */
}

.textarea-nightlife {
  /* Utilisez textarea.form-control */
}

.label-nightlife {
  /* Utilisez .form-label */
}

.error-message-nightlife {
  /* Utilisez .form-error */
}
